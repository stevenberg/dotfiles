#!/usr/bin/env ruby

require "json"
require "time"

data_file = File.join(Dir.home, ".local", "sunrise-sunset", "data.json")

system("update-sunrise-sunset") unless File.exist?(data_file)

abort "Missing sunrise-sunset data file" unless File.exist?(data_file)

data = JSON.parse(File.read(data_file))

sunrise = Time.parse(data["sunrise"])
sunset = Time.parse(data["sunset"])
now = Time.now

result = if (sunrise..sunset).cover?(now)
  "light"
else
  "dark"
end

puts result
